# Eclipse Switcher

Скрипт переключения тем согласно настройки цветовой температуры экрана

## Описание

Скрипт отслеживает значение цветовой температуры в Plasma 6 и переключает тему на указанную, при достижении определённого параметра.
Расписание смены цветовой температуры можно задать в настройках KDE.

Поддерживается переключение:
- пакета оформления KDE, как целиком, так и отдельных частей:
    - темы KDE
    - темы курсора
    - темы значков
    - обоев
- темы GTK
- темы VSCode
- цветовой схемы konsole

Приложения, на которых протестировано переключение (в Arch Linux): Dolphin, qBittorrent, Qalculate!(GTK), VSCode(OSS), Firefox, Obsidian, LibreOffice

Переключение пакета оформления работает быстрее и стабильнее чем переключение отдельных компонентов. Можно создать свои пакеты и прописать их для переключения в параметре `PACKAGES`. Стандартные пакеты, настройки которых можно использовать в качестве примера, находятся по пути `/usr/share/plasma/look-and-feel`.

## Зависимости

- Рабочее окружение Plasma 6
- `gsettings-desktop-schemas`, `kde-gtk-config`, `breeze-gtk` для поддержки переключения GTK
- `jq` для редактирования конфига VSCode

## Как пользоваться

1. Положите скрипт в каталог, из которого он будет запускаться при входе пользователя в сеанс
2. Сделайте скрипт исполняемым
3. Отредактируйте параметры по своему желанию - интервал опроса DBus, температуру переключения, желаемые темы. Если переключение какого-либо приложения не требуется, можно закомментировать соответствующий параметр
4. Выполните `./eclipse-switcher --set` для добавления скрипта в автозагрузку и немедленного запуска. После изменения параметров, для их применения тоже необходимо выполнять данную команду, иначе изменения вступят в силу только при следующем входе пользователя в систему
5. Остановить выполнение и удалить скрипт из автозагрузки можно командой `./eclipse-switcher --remove`
6. Ручное переключение в светлый / тёмный режим можно выполнить командами `./eclipse-switcher --light` и `./eclipse-switcher --dark`

## Известные проблемы

В Libre Office не происходит переключение темы значков на панелях инструментов, если смена темы происходит во время работы приложения. Помогает только повторное открытие приложения.
Эффект проявляется только при смене отдельных компонентов оформления KDE и не возникает при применении пакета целиком (через параметр PACKAGES).

При работающих экземплярах konsole, в момент переключения темы, появляется всплывающее предупреждение о выполнении команды "runCommand". Её появление обусловлено механизмом изменения цветовой схемы "на лету" с помощью отправки в консоль через DBus команды на выполнение "konsoleprofile ColorScheme=" в запущенных экземплярах konsole. Также данная команда выведется в самой консоли.

## Автор

Entropy Engineer (entropysource@ya.ru)